# HTTP와 HTTPS

작성자 : 박성민

작성일 : 2022-05-11

---

## HTTP

- Hypertext Transfer Protocol
- 웹 서버와 클라이언트 간 데이터를 교환하기 위한 통신 규약이다.
- 웹에서만 사용하는 프로토콜로 TCP/IP 기반으로 서버와 클라이언트 간 요청과 응답을 전송한다.
- 웹 브라우저와 웹 서버의 통신에는 IP가 필요하고 TCP를 기반으로 하는 통신이기에 TCP/IP 통신이라고 말한다.

### 특징

- TCP 기반의 통신 방식
- 클라이언트 - 서버 구조
  - 클라이언트가 서버에 요청을 보내면 (Request) 서버는 그에 대한 응답을 보낸다(Response).
- 무상태 프로토콜(Stateless)
  - 서버가 클라이언트의 상태를 보존하지 않는다.
  - 장점: 서버 확장성 높음(scale out - 수평 확장)
  - 단점: 클라이언트가 추가 데이터 전송
  - Stateful은 항상 같은 서버가 유지되어야 하지만, Stateless는 아무 서버나 호출해도 된다.
- 비 연결성(connectionless)
  - HTTP는 기본이 연결을 유지하지 않는 모델이다.
  - 하나의 object 전송 별로 TCP connection을 새로 생성한다.
  - 지금은 지속 연결(Persistent Connections)이다.
    - 초기에는 연결 > HTML > 종료 > 연결 > JS > 종료 > 연결 > 이미지 > 종료
    - 지속 연결은 연결 > HTML > JS > 이미지 > 종료

### 문제점

- HTTP는 평문 통신이기에 도청이 가능하다.
- 통신 상대를 확인하지 않기에 위장이 가능하다.
- 완전성을 증명할 수 없어 변조가 가능하다.

이런 문제들로 등장한게 HTTPS 이다.

## HTTPS

- Hypertext Transfer Protocol Secure
- HTTP 통신하는 소켓 부분을 인터넷 상에서 암호화하는 SSL (Secure Sockets Layer) 사용.
- HTTP는 TCP와 통신했지만, HTTPS에서는 SSL과 통신하고 SSL이 TCP와 통신한다.
- SSL은 서버와 브라우저 사이에 안전하게 암호화된 연결을 만들 수 있게 도와주고, 서버와 브라우저가 민감한 정보를 주고받을 때 해당 정보가 도난당하는 것을 막아준다.
- HTTPS는 HTTP 자체를 암호화 하는것이 아니라, HTTP를 사용해서 운반하는 내용(HTTP message body)을 암호화한다.
- HTTPS의 SSL에서는 대칭키 암호화 방식, 공개키 암호화 방식 모두 사용한다.

### 왜 HTTPS를 사용할까?

1. 보안성
   - 데이터를 전송할 때 HTTP를 사용하면 중간에 가로챘을 때 어떤 내용인지 알 수 있다.
   - HTTPS를 사용하면 암호화 되어 있어 어떤 내용인지 알 수 없다.
2. SEO(검색 엔진 최적화)
   - 구글은 HTTPS 웹 사이트에 가산점을 준다. HTTPS를 사용해야 검색 엔진에 빈번하게 노출될 확률이 증가한다.
3. AMP(가속화된 모바일 페이지)
   - AMP를 만들 때 HTTPS를 사용해야 한다.

### SSL

- SSL 프로토콜은 Netscape 사에서 웹서버와 브라우저 사이의 보안을 위해 만들어졌다.
- CA(Certifiacte Authority)라 불리는 서드 파티로부터 서버와 클라이언트의 인증을 하는데 사용된다.
- CA(Certificate Authority, 인증기관) : 웹 사이트, 이메일 주소, 회사 또는 개인과 같은 엔티티의 신원을 확인하고 전자 문서를 발행하여 암호화 키에 바인딩하는 회사 또는 조직이다. **디지털 인증서**
- SSL은 공개키/개인키 방식과 대칭키 방식을 적절히 섞어 사용한다.

### SSL 통신 과정

- SSL은 공개키 방식으로 대칭키를 전달한다.
- 이 대칭키를 활용해서 암호화와 복호화를 하고 서버와 브라우저간 통신을 진행한다.

1. A에서 B로 접속 요청을 보낸다.
2. B는 A에게 자신의 공개키를 전송한다.
3. A는 자신의 대칭키를 B에서 전달받은 공개키로 암호화 한다.
4. 암호화된 대칭키를 B에게 전달한다.
5. B는 A의 대칭키를 자신의 개인키로 복호화 한다. B는 A의 대칭키를 얻을 수 있다.
6. 이렇게 얻은 대칭키를 활용해 A와 B는 안전하게 통신한다.

**제 3의 인증기관을 포함해서 알아보자**

- 사이트는 사이트 인증서가 필요하다. (신용을 위해)
  - 사이트 인증서 : 인증기관에서 사이트에 발급해주는 문서
- 이를 위해 사이트에서 인증기관에게 사이트 정보와, 사이트 공개키를 전달한다.
- 인증기관에서 검증을 완료하면, 인증기관은 사이트 인증서를 생성하기 위해 사이트에서 전달받은 데이터를 자신의 개인키로 서명한다.
- 서명을 완료하면 사이트 인증서가 생성되고, 인증서를 사이트에 전달한다.
- 인증기관은 사용자에게 자신의 공개키를 전달한다. → 사용자 브라우저에 내장

여기까지는 사용자가 사이트 접속을 요청하기 전의 내용이다. (신용이 있는 서버인지 인증서 발급)

---

- 사용자가 사이트 접속 요청
- 사이트는 자신이 신뢰할 수 있음을 증명하기위해 인증서를 전달한다.
- 사용자는 브라우저에 내장되어 있는 인증기관 공개키로 인증서를 복호화한다.
  - 복호화 가능하다면 접속한 사이트가 인증기관에 의해 검토되었다는 것을 의미한다.
- 복호화를 하게되면 사이트의 정보와 공개키를 얻게 된다.
- 사용자는 사이트 공개키로 자신의 대칭키를 암호화해서 사이트에 전달한다.
- 사이트는 자신의 개인키로 복호화해 대칭키와 데이터 등을 얻는다.
- 사용자, 사이트 둘 다 대칭키를 얻게 되었으니 이 대칭키를 이용해 통신한다.

[참고]

[https://developer.mozilla.org/ko/docs/Web/HTTP/Overview](https://developer.mozilla.org/ko/docs/Web/HTTP/Overview)

[https://velog.io/@jaeyunn_15/Network-HTTP-vs-HTTPS](https://velog.io/@jaeyunn_15/Network-HTTP-vs-HTTPS)

[[10분 테코톡] 🍭 다니의 HTTPS](https://www.youtube.com/watch?v=wPdH7lJ8jf0&list=RDCMUC-mOekGSesms0agFntnQang&start_radio=1&rv=wPdH7lJ8jf0&t=730)
