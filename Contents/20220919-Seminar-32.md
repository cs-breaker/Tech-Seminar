# 추천 시스템

# 1. 추천 시스템이란

---

인터넷이 발전됨에 따라 아이템 구매 및 선호에 대한 사용자의 피드백을 얻기 쉬워졌다. 이런 피드백을 바탕으로 과거의 사용자-아이템 간 데이터를 활용해 취향을 고려한 아이템을 추천하는 것이 추천 시스템의 기본적인 아이디어이다.

# 2. 두 가지 추천 문제 (추천 목표)

---

- Prediction version
    - Matrix Completion이라고도 하며, 학습 데이터를 통해 유저의 선호도를 정확하게 예측하는 것이 목적이다
    - A 유저는 1번 상품을 선호할 것이다
- Ranking version
    - 정확한 수치를 예측하는 것이 아닌, 랭킹을 고려해 Top-K의 아이템을 선정하는 것이 목적이다
    - A 유저는 1, 2, 3번 상품 순으로 선호할 것이다

# 3. 명시적 피드백 vs 암시적 피드백

---

추천 시스템은 사용자가 관심을 가질만한 정보를 제공하는 시스템이다. 사용자가 무엇에 관심을 가질지를 알기 위해서는 데이터가 필요하다. 사용자가 과거에 좋았거나 싫었다고 남겼던 피드백들을 사용할 수 있다.

## 3. 1 명시적 피드백

사용자의 긍정/부정을 수치로 나타낸 데이터

아이템에 대한 사용자의 선호도를 직접적으로 알 수 있는 데이터

직관적이지만 사용자가 직접 평가해야 하므로 데이터를 얻기 어렵고 크기가 작음

## 3. 2 암시적 피드백

사용자가 아이템을 얼마나 소비했는지를 기록한 데이터

직관적으로 알 수 없는 경우 사용

긍정/부정에 대한 구분이 없음

쉽게 구할 수 있음

부정적인 피드백이 없고, 노이즈가 있음

# 4. 추천 시스템에서 사용하는 데이터

---

추천 시스템을 위해서는 사용자 데이터와 상품 데이터, 그리고 추천 점수를 필요로 한다.

## 4.1 사용자 정보

사용자의 프로필 정보를 의미한다. 예를 들면 사용자의 나이, 성별, 거주지와 같은 개인적인 신상 정보 혹은 사용자의 웹페이지 방문 기록, 클릭 패턴, 페이지 체류 시간 등 행동 정보(로그)가 있다.

사용자 정보는 평점, 설문 조사, 리뷰와 같은 직접적인 피드백을 통해 수집할 수도 있고, 웹페이지나 앱에 다녀간 흔적(체류 시간, 클릭 여부, 검색 로그 등)과 같은 간접적인 피드백을 통해 수집할 수도 있다.

## 4.2 아이템 정보

사용자에게 제공하려는 아이템은 서비스마다 각각 다르게 정의될 수 있다. SNS에서는 사용자가 업로드한 게시글과 유사한 게시글, 사용자가 관심이 있을 법한 사진이 아이템이 된다. 컨텐츠를 제공하는 서비스에서는 책, 음악, 영화, 방송이 아이템이 되고 지도 서비스에서는 여행지나 음식점을 아이템으로 선정할 수 있다.

아이템 프로필로는 아이템의 가격과 색상, 역할과 같은 고유 정보를 사용하거나 아이템을 좋아하거나 구매한 경험이 있는 사용자 집계 정보 등을 활용할 수 있다.

## 4.3 추천 점수

‘사용자가 해당 아이템을 얼마나 좋아했는가?’를 점수화한 값이다. 사용자에게 아이템을 추천하기 위해서는 준비된 아이템마다 사용자가 얼마나 좋아할지에 대한 정량화된 기준이 필요하기 때문이다. 지도 학습에서의 타겟과 같다.

위에서 사용자 정보로 언급한 평점, 행동 로그 등의 정보들을 추천 점수로도 활용할 수 있따. 어떤 값을 타겟으로 설정하느냐에 따라 성능이 크게 바뀔 수 있다.

# 5. 대표적인 추천 알고리즘의 종류

---

## 5.1 컨텐츠 기반 필터링

사용자 혹은 아이템에 대한 프로필 정보를 가지고 사용자가 좋아했던 아이템과 비슷한 유형의 아이템을 추천한다.

### 5.1.1 컨텐츠 기반 필터링의 분석 절차

1. 이미지, 음성, 태그, 상품 설명서, 리뷰 등과 같은 아이템의 설명으로부터 아이템의 특징을 추출한다
2. 알고리즘을 이용하여 과거에 좋게 평가했던 아이템 A와 유사한 아이템들을 선별한다
    1. 만약 군집화 알고리즘을 사용한다면, 아이템들을 몇 종류의 군집으로 나눈 후 아이템 A와 동일한 군집에 있는 아이템 B, C, D를 추천할 아이템 후보로 선정한다
    2. 여기서 아이템 사이의 유사성을 어떤 특징을 통해 파악할 것인지, 어떻게 계산할지가 컨텐츠 기반 필터링의 핵심
3. 사용할 수 있는 데이터에 평점이 있는 경우, 추천할 아이템 후보 중에서도 평점이 높을 것으로 예상되는 일부 아이템을 우선적으로 추천한다

### 5.1.2 컨텐츠 기반 필터링에서의 유사도

코사인 유사도

- 두 점 사이의 각도를 측정한 지표로, 값이 작으면 두 데이터가 유사하다는 의미이다

유클리드 거리

- 두 점 사이의 거리를 측정한 지표로, 값이 작으면 두 데이터가 유사하다는 의미이다

맨하탄 거리

- 두 점 사이의 거리를 측정하되, 수평-수직으로만 이동하는 거리를 측정한다

이렇게 구한 벡터간 유사도(거리)를 이용해 k-NN 알고리즘, DBSCAN과 같은 군집화 알고리즘을 적용하면 유사한 아이템들을 찾을 수 있다.

사용자가 좋아했던 아이템들이 속하는 군집을 찾고, 그 군집에 포함된 다른 아이템들을 추천한다.

### 5.1.3 컨텐츠 기반 필터링의 장단점

장점

- 다른 사용자들의 데이터가 없어도 추천이 가능하다
    - 추천을 제공받는 사용자의 컨텐츠 이용내역만 있으면 된다
- 새로 추가된 아이템, 평점이 없는 유명하지 않은 아이템도 추천이 가능하다
    - 아이템의 설명만 있다면 다양한 아이템이 후보군이 될 수 있다
- 추천의 근거를 설명할 수 있다
    - 아이템의 feature를 이용해 아이템 간의 유사성을 계산하기 때문에 어떤 특징이 유사성의 근거가 되는지 파악할 수 있다

단점

- 아이템의 설명을 구성하는 과정에서 주관성이 개입될 수 있다
    - 사용자 A는 영화 X를 흥미진진하다, 박진감 넘친다고 평가할 수 있지만, 반대로 사용자 B는 동일한 영화를 두고 폭력적이라고 평가할 수 있다
- 사용자가 과거에 좋아했던 아이템을 제공하지 않으면 추천이 어렵다 (콜드 스타트)
    - 때문에 몇몇 동영상 서비스 플랫폼에서는 사용자가 서비스를 이용하기 전, 이전에 보았던 영상에 대한 평가를 받는다
    - 이 과정이 어렵다면 사용자의 단순 프로필을 이용하여 매스마케팅식으로 아이템을 제공하고, 이후에 사용 이력이 쌓이면 그때부터 개인화 추천을 시도한다
- 아이템 속성 정보 간의 연관성을 바탕으로 하기 때문에 사용자가 이미 알고 있거나, 알고 있는 것과 유사한 아이템만을 주로 추천하는 문제점이 있다
    - 지나치게 특정된 아이템만을 추천하여 사용자의 다양한 취향을 반영할 수 없다
    - 필터 버블 : 개인화 추천으로 생긴 정보 편식 현상으로, 사용자가 제한된 주제와 관점을 가진 정보만을 접하게 되는 것을 말한다. 필터링된 정보만을 취득하여 다양한 생각을 알 수 없게 되고 스스로 가치판단을 할 수 없게된다는 문제가 있다

## 5.2 협업 필터링

‘특정 상품에 대한 선호도가 유사한 고객들은 다른 상품에 대해서도 선호도가 비슷할 것이다’ 라는 가정하에 사용자의 아이템 평가 데이터를 이용해 비슷한 선호도를 갖는 다른 사용자가 선택한 아이템을 추천한다.

협업 필터링은 크게 이웃 기반 협업 필터링(메모리 기반 협업 필터링)과 모델 기반 협업 필터링(잠재 요인 협업 필터링)으로 나누어져 있다.

### 5.2.1 이웃 기반 협업 필터링

이웃 기반 협업 필터링은 사용자가 아이템에 대해 남긴 평점 데이터를 이용하여 아직 평점을 남기지 않은 아이템들에 대해 예측을 수행하고, 예측 평점이 높은 N개의 아이템을 추천하는 방식이다.

사용자와 아이템을 각각 행과 열의 인덱스로 두고, 사용자가 과거에 경험한 아이템에 대해 평가를 하고, 경험하지 않은 아이템은 빈 값으로 둔다. 이 빈 값을 채워서 예상 평점을 높게 받은 아이템을 추천한다.

이웃 기반 협업 필터링은 ‘어떤 것끼리 유사도를 계산할 것인가’를 기준으로 사용자 기반 협업 필터링과 아이템 기반 협업 필터링으로 나눌 수 있다.

**5.2.1.1 사용자 기반 협업 필터링**

사용자 기반 협업 필터링은 사용자 간 유사도를 계산한다. 사용자 간 유사도를 추정해 유사한 사용자를 판별하고, 한 사용자가 사용했지만 다른 사용자가 사용하지 않은 아이템을 추천한다.

**5.2.1.2 아이템 기반 협업 필터링**

아이템 기반 협업 필터링은 아이템 간 유사도를 계산한다. 아이템 간 유사도를 추정해 사용자가 사용한 아이템과 유사한 사용하지 않은 아이템을 추천한다.

### 5.2.2 모델 기반 협업 필터링

머신 러닝을 활용하는 추천 알고리즘의 일종으로 주어진 데이터를 활용하여 모델을 학습한다. 항목간 유사성보다는 데이터의 패턴을 학습하며 유저의 잠재적 특성(선호하는 취향)을 파악한다.

## 5.3 하이브리드 필터링

컨텐츠 기반 필터링과 협업 필터링을 결합한 모델로, 두 가지 알고리즘을 모두 적용해 아이템마다 가중 평균을 구해 랭킹을 매기는 방법, 평점 데이터와 아이템 프로필을 조합해 사용자 프로필을 만들어 추천하는 방법 등 다양한 기법이 있다. 

[출처]

[https://abluesnake.tistory.com/103?category=1204978](https://abluesnake.tistory.com/103?category=1204978)

[https://dsbook.tistory.com/334?category=880617](https://dsbook.tistory.com/334?category=880617)